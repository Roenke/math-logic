\def\doubleunderline#1{\underline{\underline{#1}}}

Мы будем говорить, что два множества разрешимо равномощны, если у этих множеств есть аналоги в виде типов языка хаскелл,
    и между этими типами существуют взаимно обратные функции языка хаскелл
Аналогом множества $\mathbb{N}$ является тип $data\ Nat\ = Zero\ |\ Suc\ Nat$.
Аналогом множества $\{0,1\}^*$ является тип $[Bool]$.
Если $X$ -- подмножество $\{0,1\}^*$, то его аналогом является тип $type X = [Bool]$, но предполагается,
    что в функции $X \to a$ не передаются аргументы, выходящие за пределы $X$, и функции $a \to X$ не возвращают результат, выходящий за его пределы.

\begin{enumerate}

\item Докажите, что $\mathbb{N}$ и $\{0,1\}^*$ разрешимо равномощны, где второе множество -- это множество последовательностей из 0 и 1.

\textbf{Решение.} Построим две инъекции. Применим теорему Кантора-Берштейна. 

$f:\mathbb{N} \rightarrow \{0, 1\}*$. - представление числа в двоичной системе исчисления. Инъективность очевидна.

$g:\{0,1\}^* \rightarrow \mathbb{N}$.- добавим к каждому члену последовательности из $0$ и $1$ 
по единице, получим число в троичной системе исчисления без ведущих нулей. Переведем его в 
десятичную систему исчисление. Инъективность следует из отсутствия ведущих нулей и биекцией 
между троичной и десятичной системами исчисления. 

Равномощность следует из теоремы Кантора-Бернштейна.

\item Докажите, что $\{0,1\}^*$ и $\mathbb{N}_2$ разрешимо равномощны, где второе множество -- 
это множество двоичных натуральных чисел,
    то есть последовательностей 0 и 1 без ведущих нулей (кроме случая, когда 
    последовательность состоит из одной цифры).
    
\textbf{Решение.} Заметим, что между $\mathbb{N}_2$ и $\mathbb{N}$ существует биекция - 
перевод числа в двоичную систему и обратно, то задача становится эквивалентна первой.   

\item Докажите, что $\{0,1\}^*$ и множество корректных программ на каком-либо (любом) языке 
программирования разрешимо равномощны.

\textbf{Решение.} Построим две инъекции. Применим теорему Кантора-Берштейна. 

Обозначим $P$ - множество корректных программ. Тогда, можно определить следующие инъекции:

$f:P \rightarrow \{0,1\}^*$ - Бинарное представление скомпилированной программы в памяти. Инъективность очевидна.


$g:\{0,1\}^* \rightarrow P$ - Программа, состоящая из одной команды печати соответствующей 
последовательности нулей и единиц, которая указана в аргументах у команды печати. Тогда, если 
$g(a) = g(a') \Rightarrow $ выведется одна и та же строка $\Rightarrow a = a'$. 

Равномощность следует из теоремы Кантора-Бернштейна.

\item Определите множество простых чисел.

\textbf{Решение.} Воспользуемся \textit{separation axiom}. Тогда множество простых чисел можно определить так:
\begin{equation*}
	Prime = \{p \in \mathbb{N} \ | \ \forall k \leqslant \lfloor \sqrt{p} \rfloor (\gcd(p, k) = 1) \}
\end{equation*}

\item Определите следующие функции над $\mathbb{Q}$ и докажите их корректность:
Рациональное число можно представить как пару $(p, q)$, где $p \in \mathbb{Z}, q \in \mathbb{N}$. 
\begin{enumerate}
\item Функция $neg : \mathbb{Q} \to \mathbb{Q}$, возвращающая обратное по сложению число.
\begin{equation*}
	neg = (p, q) \mapsto ((-p), q)
\end{equation*}

Корректность: Функция сохраняет эквивалентность: если $(x,y) \sim (x',y')$, то $neg([(x,y)]_\sim) 
\sim neg([(x',y')]_\sim)$. 

Это свойство выполнено: 

$neg([(x,y)]_\sim) = (-x, y)$, 

$neg([(x',y')]_\sim) = (-x', y')$. 

Заметим, что $(-x, y) \sim (-x', y') \Leftrightarrow -xy' = -x'y 
\Leftrightarrow xy' = x'y \Leftrightarrow (x,y) \sim (x',y')$. Показали, что эквивалентность 
сохранена.

\item Функция $inv : \mathbb{Q}_{\neq 0} \to \mathbb{Q}_{\neq 0}$, возвращающая обратное по умножению число.
\begin{equation*}
	inv = (p, q) \mapsto ((sign \ p) * q, abs \ p)
\end{equation*}

Корректность: Функция сохраняет эквивалентность: если $(x,y) \sim (x',y')$, то $inv([(x,y)]_\sim) 
\sim inv([(x',y')]_\sim)$. 

Это свойство выполнено: 

$inv([(x,y)]_\sim) = (sign(x) *y, x)$, 

$inv([(x',y')]_\sim) = (sign(x') * y', x')$. 

Заметим, что $sign(x) *y, x \sim sign(x') * y', x' 
\Leftrightarrow sign(x) * y * x' = (sign(x') * y' * x \Leftrightarrow x'y = xy' \Leftrightarrow (x,y) 
\sim (x',y')$. Показали, что эквивалентность сохранена.

\item Функция $plus : \mathbb{Q} \times \mathbb{Q} \to \mathbb{Q}$, возвращающая сумму двух чисел.
\begin{equation*}
	plus = ((p1, q1),  (p2, q2)) \mapsto (p1 * q2 + p2 * q1, q1 * q2)
\end{equation*}

Корректность: Функция сохраняет эквивалентность: если $(x_1,y_1) \sim (x_1',y_1')$ и $(x_2,y_2) \sim (x_2',y_2')$, то $plus([(x_1,y_1), (x_2, y_2)]_\sim) 
\sim plus([(x_1',y_1'), (x_2', y_2')]_\sim)$. 

Это свойство выполнено:

 $plus([(x_1,y_1), (x_2, y_2)]_\sim)     = (x_1 * y_2 + x_2 * y_1, y_1 * y_2)$,
 
 $plus([(x_1',y_1'), (x_2', y_2')]_\sim) = (x_1' * y_2' + x_2' * y_1', y_1' * y_2')$. 
 
 Заметим, что $(x_1 * y_2 + x_2 * y_1, y_1 * y_2) \sim (x_1' * y_2' + x_2' * y_1', y_1' * y_2') 
\Leftrightarrow (x_1 * y_2 + x_2 * y_1) * (y_1' * y_2') = (y_1 * y_2) * (x_1' * y_2' + x_2' * y_1') \Leftrightarrow x_1  y_2  y_1'  y_2' + x_2  y_1  y_1'  y_2' 
              = x_1'  y_2'  y_1  y_2 + x_2'  y_1'  y_1  y_2$
 
 Воспользуемся 
 $$(x_1,y_1) \sim (x_1',y_1') \Leftrightarrow x_1y_1' = x_1'y_1 = a$$
 $$(x_2,y_2) \sim (x_2',y_2') \Leftrightarrow x_2y_2' = x_2'y_2 = b$$
 
 Получим: 
 $$ y_2 y_2' \underline{y_1'x_1} +  y_1  y_1' \doubleunderline{x_2y_2'} 
 = \underline{x_1'y_1}  y_2' y_2 + \doubleunderline{x_2'y_2}  y_1'  y_1 \Leftrightarrow 
 a y_2 y_2' + b y_1  y_1' = a y_2' y_2 + b y_1'  y_1 $$
Последнее равенство очевидно, значит эквивалентность сохранена.

\end{enumerate}

\item Докажите, что существует биекция между двумя вариантами определения множества $\Pi (a \in A) B_a$, приведенных в лекции.

\item \label{it:vec}
    Пусть $Vec(A,n)$ -- множество списков длины $n$, элементы которых лежат в множестве $A$.
    В лекции был приведен пример функции $index$.
    Опишите аналогичным образом ``тип'' функций (то есть в каком множестве они лежат, все эти множества будут множествами зависимых функций), приведенных ниже.
    Каждая из этих функций должна принимать и возвращать элементы множеств вида $Vec(A,n)$ и, возможно, другие аргументы.
\begin{enumerate}
\item Функция $reverse$, разворачивающая список.

\textbf{Решение.} $$reverse : \Pi(n \in \mathbb{N}) (Vec(A, n) \rightarrow Vec(A, n)) $$

\item Функция $append$, конкатенирующая два списка.

\textbf{Решение.} $$append : \Pi((n,m) \in \mathbb{N}^2) (Vec(A, n) \rightarrow Vec(A, m) 
\rightarrow Vec(A, n + m)) $$

\item Функция $filter$, принимающая предикат и список длины $n$, и возвращающая список, с 
элементами исходного списка, которые удовлетворяют предикату.
\textbf{Решение.} $$filter : \Pi(n \in \mathbb{N}) (\{f:A\rightarrow \{\top, \bot}\}\} 
\rightarrow Vec(A, n) \rightarrow \{v \in Vec(A, j) \ \big| \ j \in \mathbb{N}\cup {0}, j 
\leqslant n\}) $$
\end{enumerate}

\item Задания на хаскелле:
\begin{enumerate}
\item См. cb.hs.
\item Пусть $\mathbb{N}_{\geq 2} = \{ n \in \mathbb{N}\ |\ n \geq 2 \}$ и $m : \mathbb{N}_{\geq 2} \times \mathbb{N}_{\geq 2} \to \mathbb{N}$ вовзращает произведение чисел, то есть $m(x,y) = x \cdot y$.
    На лекции мы видели, что существует отношение эквивалентности $\sim$ на $\mathbb{N}_{\geq 2} \times \mathbb{N}_{\geq 2}$, такое что $(\mathbb{N}_{\geq 2} \times \mathbb{N}_{\geq 2})/\!\!\sim$ равномощно $im(m)$.
    Задайте тип на хаскелле, аналогичный $(\mathbb{N}_{\geq 2} \times \mathbb{N}_{\geq 2})/\!\!\sim$ (вам понадобится задать $instance\ Eq$ для него).
    Определите биекцию на хаскелле между этим типом и $im(m)$.
\item
{
    Определите на хаскелле два варианта рациональных чисел: один через отношение эквивалентности, другой через канонические представители.
}
    Определите биекцию между ними.
\end{enumerate}

\item Опциональная задача для любителей программирования с зависимыми типами. Реализуйте функции из задания \ref{it:vec} на агде.

\end{enumerate}

\end{document}
